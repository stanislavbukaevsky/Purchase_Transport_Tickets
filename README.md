# Сервис для покупки транспортных билетов

### **Задача**

Разработать REST Full API для покупки транспортных билетов, позволяющий пользователям регистрироваться, входить в
систему,
покупать свободные для продажи транспортные билеты, просматривать билеты по различным атрибутам и просматривать
купленные билеты конкретным пользователем. Также разработана система разделения ролей и сервис для администраторов
приложения.

**В проекте реализован следующий функционал:**

- Регистрация нового пользователя.
- Авторизация и аутентификация пользователей.
- Реализован функционал получения JWT токенов.
- Распределение ролей между пользователями: покупатель и администратор.
- Авторизированный пользователь может купить свободный транспортный билет.
- Пользователь может просмотреть список свободных транспортных билетов по различным атрибутам.
- Также, пользователь может получить список купленных билетов текущем пользователем.
- Пользователи, являющиеся администраторами имеют право добавить/изменить/удалить перевозчика, маршрут и транспортный
  билет.
- Добавлена функция кеширования купленных билетов в Redis.
- Разработан функционал разделения проекта на 2 микросервиса при помощи Apache Kafka.

***

## **Функционал**

### В приложении использован следующий функционал:

- Java 17;
- Spring Boot 3.1.4;
- Maven;
- Spring WevFlux;
- Spring Security;
- Apache Kafka;
- Reactor Kafka;
- JWT;
- Jooq;
- Redis;
- PostgresSQL;
- Liquibase;
- Mapstruct;
- Lombok;
- Swagger-UI.

## **Запуск приложения**

### Для запуска приложения выполните следующие действия

**1. Настройка файла application.properties**

- Для работы приложения вам нужно правильно настроить
  файл **[application.properties](src/main/resources/application.properties)**.
  Открыв этот файл вы увидете множество заглушек, которые нужно описать.
- Создайте в корне проекта файл с названием **.env** (не забудьте символ точки перед названием файла!) и опишите все
  значения
  переменных как это показано ниже

```
SPRING_DATASOURCE_HOST=Локальный хостинг вашего сервера
SPRING_DATASOURCE_PORT=Порт вашего сервера
SPRING_DATASOURCE_DATABASE=Название базы данных
SPRING_DATASOURCE_USERNAME=Имя пользователя базы данных
SPRING_DATASOURCE_PASSWORD=Пароль пользователя базы данных

SECURITY_PASSWORD_SECRET=Секретный ключ для шифрования пароля в приложении
SECURITY_PASSWORD_ITERATION=Количество итерраций для шифрования пароля в приложении (указывается целое число)
SECURITY_PASSWORD_KEY_LENGTH=Длина ключа для шифрования пароля в приложении (указывается целое число)

JWT_SECRET_KEY_ACCESS=Секретный ключ для access токена в приложении
JWT_SECRET_KEY_REFRESH=Секретный ключ для refresh токена в приложении

SPRING_REDIS_SERVER_HOST=Локальный хостинг вашего сервера Redis
SPRING_REDIS_SERVER_PORT=Порт вашего сервера Redis
SPRING_REDIS_TOPIC=Название топика для Redis

KAFKA_BOOTSTRAP_SERVERS_HOST=Локальный хостинг вашего сервера Kafka
KAFKA_BOOTSTRAP_SERVERS_PORT=Порт вашего сервера Kafka
SPRING_KAFKA_SUBSCRIBER_TOPIC=Название топика для Kafka

```

**2. Настройка файла pom.xml**

- Откройте файл **[pom.xml](pom.xml)** и найдите в нем следующие строки в теге ```<properties>```

````html

<db.driver>org.postgresql.Driver</db.driver>
<db.url>Полный путь к базе данных (url)</db.url>
<db.username>Имя пользователя базы данных</db.username>
<db.password>Пароль пользователя базы данных</db.password>
````

- Эти поля в тегах нужно заполнить для библиотеки Jooq.

**3. Подключения сервера Redis**

- Скачайте и установите **[Redis](https://redis.io/download/)** к себе на компьютер.
- Запустите сервер файлом **redis-server.**

**4. Подключения сервера Kafka**

- Скачайте и установите **[Kafka](https://kafka.apache.org/quickstart)** к себе на компьютер.
- Запустите сервер zookeeper и kafka.
- Теперь запустите приложение в
  файле [PurchaseTransportTicketsApplication](src/main/java/com/github/stanislavbukaevsky/purchasetransporttickets/PurchaseTransportTicketsApplication.java)
  .

***

## **Разработка**

### В реализации проекта принимал участие:

- Букаевский Станислав - [ссылка на GitHub](https://github.com/stanislavbukaevsky)